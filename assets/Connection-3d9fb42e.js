import{w}from"./jsonMap-ffa742d3.js";import{a as v,s as R}from"./Error-5cdd6e0a.js";import{p as J,a as f,v as T,C as N,j,r as W,A as C,f as D}from"./promiseUtils-5940888c.js";import{N as P,p as b,r as V}from"./typedArrayUtil-bf9f210a.js";import{_ as h}from"./preload-helper-41c905a7.js";import{d as $}from"./request-09e7d9b2.js";import{h as M}from"./string-53224faa.js";const B="20230222",H="f17172bab03d767d6c0b1299b23ed7d4aba5edea";let Q=class{constructor(e=t=>t.values().next().value){this._peeker=e,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}last(){if(this._items.size===0)return;let e;for(e of this._items);return e}peek(){if(this._items.size!==0)return this._peeker(this._items)}push(e){this.contains(e)||this._items.add(e)}contains(e){return this._items.has(e)}pop(){if(this.length===0)return;const e=this.peek();return this._items.delete(P(e)),e}popLast(){if(this.length===0)return;const e=this.last();return this._items.delete(P(e)),e}remove(e){this._items.delete(e)}filter(e){return this._items.forEach(t=>{e(t)||this._items.delete(t)}),this}};var c;(function(o){o[o.HANDSHAKE=0]="HANDSHAKE",o[o.OPEN=1]="OPEN",o[o.OPENED=2]="OPENED",o[o.RESPONSE=3]="RESPONSE",o[o.INVOKE=4]="INVOKE",o[o.ABORT=5]="ABORT",o[o.CLOSE=6]="CLOSE",o[o.OPEN_PORT=7]="OPEN_PORT",o[o.ON=8]="ON"})(c||(c={}));let K=0;function x(){return K++}function z(o){return o&&typeof o=="object"&&("result"in o||"transferList"in o)}function E(o){return o?typeof o=="string"?JSON.stringify({name:"message",message:o}):o.toJSON?JSON.stringify(o):JSON.stringify({name:o.name,message:o.message,details:o.details||{stack:o.stack}}):null}function L(o,e,t,s){if(e.type===c.OPEN_PORT)return void o.postMessage(e,[e.port]);if(e.type!==c.INVOKE&&e.type!==c.RESPONSE)return void o.postMessage(e);let r;if(z(t)?(r=k(t.transferList),e.data=t.result):(r=k(s),e.data=t),r){if(M("ff")){for(const n of r)if("byteLength"in n&&n.byteLength>267386880){const i="Worker call with large ArrayBuffer would crash Firefox";switch(e.type){case c.INVOKE:throw i;case c.RESPONSE:return void L(o,{type:c.RESPONSE,jobId:e.jobId,error:E(i)})}}}o.postMessage(e,r)}else o.postMessage(e)}function O(o){if(!o)return null;const e=o.data;return e?typeof e=="string"?JSON.parse(e):e:null}function k(o){if(!o||!o.length)return null;if(M("esri-workers-arraybuffer-transfer"))return o;const e=o.filter(t=>!F(t));return e.length?e:null}function F(o){return o instanceof ArrayBuffer||o&&o.constructor&&o.constructor.name==="ArrayBuffer"}const U={statsWorker:()=>h(()=>import("./statsWorker-95c172b0.js"),["./statsWorker-95c172b0.js","./geometry-7d866d3f.js","./ArrayPool-b51874dd.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./Error-5cdd6e0a.js","./Extent-22afa84a.js","./jsonMap-ffa742d3.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Ellipsoid-89682c5e.js","./Polyline-82cb63bc.js","./typeUtils-1714017f.js","./screenUtils-410d12c0.js","./quantizationUtils-16db4e0b.js","./fieldUtils-d430f46c.js","./preload-helper-41c905a7.js","./arcadeOnDemand-dd48afd7.js","./heatmapUtils-8ee685fd.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./vec4f64-6d0e93be.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js"],import.meta.url),geometryEngineWorker:()=>h(()=>import("./geometryEngineWorker-8a57eda3.js"),["./geometryEngineWorker-8a57eda3.js","./geometryEngineJSON-3f330436.js","./geometryEngineBase-e1a33b0a.js","./json-48e3ea08.js"],import.meta.url),CSVSourceWorker:()=>h(()=>import("./CSVSourceWorker-7b6e1710.js"),["./CSVSourceWorker-7b6e1710.js","./geometry-7d866d3f.js","./ArrayPool-b51874dd.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./Error-5cdd6e0a.js","./Extent-22afa84a.js","./jsonMap-ffa742d3.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Ellipsoid-89682c5e.js","./Polyline-82cb63bc.js","./typeUtils-1714017f.js","./request-09e7d9b2.js","./preload-helper-41c905a7.js","./asyncUtils-24bd37b2.js","./projection-4ac247db.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./aaBoundingRect-2fb32e32.js","./zscale-baa108ea.js","./json-48e3ea08.js","./OptimizedFeature-3e582950.js","./FeatureStore-4cc4d41d.js","./Evented-686173eb.js","./aaBoundingBox-fb003858.js","./featureConversionUtils-aead6959.js","./jsonUtils-36bf3d33.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-d90f19c6.js","./PooledRBush-2aadabe0.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-9ce8e144.js","./centroid-0766e68a.js","./QueryEngineResult-0c6179e0.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./SnappingCandidate-970faec6.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngine-b5607f4f.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./reactiveUtils-53e5756b.js","./number-08a18d0d.js","./locale-fe7cc1d0.js","./clientSideDefaults-07bb3352.js","./defaultsJSON-59981e75.js"],import.meta.url),EdgeProcessingWorker:()=>h(()=>import("./EdgeProcessingWorker-28567503.js"),["./EdgeProcessingWorker-28567503.js","./workerHelper-2d7b0d57.js","./BufferView-b402c7a7.js","./vec2-848c6cf0.js","./common-d0b63c2d.js","./vec3-8818fe1c.js","./vec4-c7a19f0d.js","./InterleavedLayout-07cc6753.js","./types-e1c0a5bf.js","./edgeProcessing-ac701714.js","./deduplicate-a70aec6f.js","./mathUtils-ae09f98b.js","./Indices-f9b34f39.js","./typedArrayUtil-bf9f210a.js","./VertexAttribute-15d1866a.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),ElevationSamplerWorker:()=>h(()=>import("./ElevationSamplerWorker-a1fa5038.js"),["./ElevationSamplerWorker-a1fa5038.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./PooledRBush-2aadabe0.js","./jsonMap-ffa742d3.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./quickselect-56c5966e.js","./georeference-70533906.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./mat3f64-50f3b9f6.js","./mat4-f0dc8788.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./mat4f64-abdda1bb.js","./mat3-4fd89d48.js","./projection-4ac247db.js","./preload-helper-41c905a7.js","./mathUtils-ae09f98b.js","./vec4-c7a19f0d.js","./SimpleObservable-bd2c3ae8.js","./Polyline-82cb63bc.js","./assets-94d592bf.js","./request-09e7d9b2.js","./aaBoundingRect-2fb32e32.js","./zscale-baa108ea.js","./spatialReferenceEllipsoidUtils-88aa82c4.js","./quat-77a0169c.js","./quatf64-f8f1c132.js","./projection-03824933.js","./BufferView-b402c7a7.js","./vec2-848c6cf0.js","./vec33-ca555933.js"],import.meta.url),FeatureServiceSnappingSourceWorker:()=>h(()=>import("./FeatureServiceSnappingSourceWorker-a5f3619f.js"),["./FeatureServiceSnappingSourceWorker-a5f3619f.js","./jsonMap-ffa742d3.js","./typedArrayUtil-bf9f210a.js","./string-53224faa.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Evented-686173eb.js","./reactiveUtils-53e5756b.js","./HandleOwner-6217a02e.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./FeatureStore-4cc4d41d.js","./aaBoundingBox-fb003858.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./featureConversionUtils-aead6959.js","./jsonUtils-36bf3d33.js","./Polyline-82cb63bc.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./BoundsStore-d90f19c6.js","./PooledRBush-2aadabe0.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-9ce8e144.js","./centroid-0766e68a.js","./QueryEngineResult-0c6179e0.js","./preload-helper-41c905a7.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./request-09e7d9b2.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngine-b5607f4f.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./TileInfo-9973cd47.js","./Query-b0193ce7.js","./TimeExtent-64e16588.js","./Field-945b2973.js","./fieldType-24ac97df.js","./Clonable-7fa7ad97.js","./ElevationInfo-005ddd87.js","./lengthUtils-3c9047c4.js","./symbologySnappingCandidates-0fa731a6.js","./LRUCache-86d9ad15.js","./asyncUtils-24bd37b2.js","./arcgisLayerUrl-1b8d6c52.js","./persistableUrlUtils-3635dccc.js","./pbfQueryUtils-481b10bc.js","./pbf-845dcafd.js","./query-b4dff312.js","./queryZScale-f6e44ca7.js","./byteSizeEstimations-f0cab514.js"],import.meta.url),GeoJSONSourceWorker:()=>h(()=>import("./GeoJSONSourceWorker-6f229b44.js"),["./GeoJSONSourceWorker-6f229b44.js","./request-09e7d9b2.js","./preload-helper-41c905a7.js","./Error-5cdd6e0a.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./promiseUtils-5940888c.js","./asyncUtils-24bd37b2.js","./jsonMap-ffa742d3.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./jsonUtils-36bf3d33.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./Polyline-82cb63bc.js","./featureConversionUtils-aead6959.js","./aaBoundingBox-fb003858.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-4cc4d41d.js","./Evented-686173eb.js","./BoundsStore-d90f19c6.js","./PooledRBush-2aadabe0.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-9ce8e144.js","./centroid-0766e68a.js","./QueryEngineResult-0c6179e0.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngine-b5607f4f.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./reactiveUtils-53e5756b.js","./geojson-2fb0c3b0.js","./clientSideDefaults-07bb3352.js","./defaultsJSON-59981e75.js","./sourceUtils-b562bcf7.js","./fieldType-24ac97df.js"],import.meta.url),LercWorker:()=>h(()=>import("./LercWorker-a9efc4c0.js"),["./LercWorker-a9efc4c0.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js"],import.meta.url),MemorySourceWorker:()=>h(()=>import("./MemorySourceWorker-e2e7ed83.js"),["./MemorySourceWorker-e2e7ed83.js","./Error-5cdd6e0a.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./jsonUtils-36bf3d33.js","./Extent-22afa84a.js","./jsonMap-ffa742d3.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Ellipsoid-89682c5e.js","./Polyline-82cb63bc.js","./featureConversionUtils-aead6959.js","./aaBoundingBox-fb003858.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./objectIdUtils-789e911a.js","./FeatureStore-4cc4d41d.js","./Evented-686173eb.js","./BoundsStore-d90f19c6.js","./PooledRBush-2aadabe0.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-9ce8e144.js","./centroid-0766e68a.js","./QueryEngineResult-0c6179e0.js","./preload-helper-41c905a7.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./request-09e7d9b2.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngine-b5607f4f.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./reactiveUtils-53e5756b.js","./clientSideDefaults-07bb3352.js","./defaultsJSON-59981e75.js","./sourceUtils-b562bcf7.js","./fieldType-24ac97df.js"],import.meta.url),PBFDecoderWorker:()=>h(()=>import("./PBFDecoderWorker-02798e3c.js"),["./PBFDecoderWorker-02798e3c.js","./compilerUtils-7bf6df9e.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./jsonMap-ffa742d3.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./zscale-baa108ea.js","./dehydratedFeatures-efdbcd90.js","./byteSizeEstimations-f0cab514.js","./aaBoundingBox-fb003858.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./quantizationUtils-16db4e0b.js","./Polyline-82cb63bc.js","./typeUtils-1714017f.js","./Field-945b2973.js","./enumeration-925aa0f6.js","./fieldType-24ac97df.js","./featureConversionUtils-aead6959.js","./jsonUtils-36bf3d33.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./pbfQueryUtils-481b10bc.js","./pbf-845dcafd.js"],import.meta.url),Pipeline:()=>h(()=>import("./Pipeline-bcfa6e6b.js").then(o=>o.P),["./Pipeline-bcfa6e6b.js","./jsonMap-ffa742d3.js","./typedArrayUtil-bf9f210a.js","./string-53224faa.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./HandleOwner-6217a02e.js","./reactiveUtils-53e5756b.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./TileInfo-9973cd47.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./preload-helper-41c905a7.js","./featureConversionUtils-aead6959.js","./aaBoundingBox-fb003858.js","./jsonUtils-36bf3d33.js","./Polyline-82cb63bc.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./QueryEngine-b5607f4f.js","./MemCache-b4d68123.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./request-09e7d9b2.js","./QueryEngineResult-0c6179e0.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./StreamFeatureManager-28e50223.js","./Evented-686173eb.js","./quickselect-56c5966e.js","./diffUtils-1bae97a1.js","./Collection-74ae958a.js","./ArcadeDate-9f8ea201.js","./arcadeTimeUtils-7457ad37.js","./TimeReference-adaa7961.js","./Clonable-7fa7ad97.js","./centroid-0766e68a.js","./arcgisLayerUrl-1b8d6c52.js","./persistableUrlUtils-3635dccc.js","./ogcFeatureUtils-6af58ccf.js","./geojson-2fb0c3b0.js","./clientSideDefaults-07bb3352.js","./defaultsJSON-59981e75.js","./fieldType-24ac97df.js","./query-b4dff312.js","./pbfQueryUtils-481b10bc.js","./pbf-845dcafd.js","./queryZScale-f6e44ca7.js","./TimeExtent-64e16588.js","./Query-b0193ce7.js","./Field-945b2973.js","./createConnection-7407496c.js","./enums-c655c737.js","./TileInfoView-629d0576.js","./TileKey-4d1284e4.js","./enums-fc527c7c.js","./number-b10bd8f5.js"],import.meta.url),PointCloudWorker:()=>h(()=>import("./PointCloudWorker-7b7eb5e4.js"),["./PointCloudWorker-7b7eb5e4.js","./typedArrayUtil-bf9f210a.js","./quat-77a0169c.js","./mat3f64-50f3b9f6.js","./quatf64-f8f1c132.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./quatf32-51a323b8.js","./vec3f32-01c06d8d.js","./projection-4ac247db.js","./preload-helper-41c905a7.js","./Error-5cdd6e0a.js","./string-53224faa.js","./mathUtils-ae09f98b.js","./promiseUtils-5940888c.js","./Extent-22afa84a.js","./jsonMap-ffa742d3.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./Ellipsoid-89682c5e.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./Polyline-82cb63bc.js","./assets-94d592bf.js","./request-09e7d9b2.js","./aaBoundingRect-2fb32e32.js","./zscale-baa108ea.js","./PointCloudWorkerUtil-9740f803.js","./PointCloudUniqueValueRenderer-797177d9.js","./enumeration-925aa0f6.js","./ColorStop-29c89bbb.js","./Color-7b46c33a.js","./colorUtils-639f4d25.js","./I3SBinaryReader-1333d96d.js","./VertexAttribute-15d1866a.js"],import.meta.url),RasterWorker:()=>h(()=>import("./RasterWorker-dcba3bb4.js"),["./RasterWorker-dcba3bb4.js","./geometry-7d866d3f.js","./ArrayPool-b51874dd.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./Error-5cdd6e0a.js","./Extent-22afa84a.js","./jsonMap-ffa742d3.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Ellipsoid-89682c5e.js","./Polyline-82cb63bc.js","./typeUtils-1714017f.js","./projection-4ac247db.js","./preload-helper-41c905a7.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./request-09e7d9b2.js","./aaBoundingRect-2fb32e32.js","./zscale-baa108ea.js","./dataUtils-95926d18.js","./colorUtils-c0f43caf.js","./Color-7b46c33a.js","./colorUtils-639f4d25.js","./utils-4b22c501.js","./enumeration-925aa0f6.js","./colorRamps-18bbdf60.js","./rasterProjectionHelper-61d493f4.js"],import.meta.url),SceneLayerSnappingSourceWorker:()=>h(()=>import("./SceneLayerSnappingSourceWorker-c71b31e4.js"),["./SceneLayerSnappingSourceWorker-c71b31e4.js","./jsonMap-ffa742d3.js","./typedArrayUtil-bf9f210a.js","./string-53224faa.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./lineSegment-4eb8b6fa.js","./mathUtils-ae09f98b.js","./vec4-c7a19f0d.js","./sphere-a48b65b1.js","./mat4-f0dc8788.js","./vec4f64-6d0e93be.js","./byteSizeEstimations-f0cab514.js","./mat3f64-50f3b9f6.js","./mat4f64-abdda1bb.js","./quatf64-f8f1c132.js","./vec2f64-70cfd09e.js","./QueryEngineResult-0c6179e0.js","./preload-helper-41c905a7.js","./Polyline-82cb63bc.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./assets-94d592bf.js","./request-09e7d9b2.js","./aaBoundingRect-2fb32e32.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./jsonUtils-36bf3d33.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./featureConversionUtils-aead6959.js","./aaBoundingBox-fb003858.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./Octree-813f29c9.js","./plane-01584357.js","./Util-513876a8.js","./edgeProcessing-ac701714.js","./deduplicate-a70aec6f.js","./Indices-f9b34f39.js","./InterleavedLayout-07cc6753.js","./BufferView-b402c7a7.js","./vec2-848c6cf0.js","./types-e1c0a5bf.js","./VertexAttribute-15d1866a.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js"],import.meta.url),SceneLayerWorker:()=>h(()=>import("./SceneLayerWorker-6a8d059d.js").then(o=>o.S),["./SceneLayerWorker-6a8d059d.js","./typedArrayUtil-bf9f210a.js","./preload-helper-41c905a7.js","./assets-94d592bf.js","./Error-5cdd6e0a.js","./string-53224faa.js","./request-09e7d9b2.js","./promiseUtils-5940888c.js","./I3SNode-3d136092.js","./sphere-a48b65b1.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./mat4-f0dc8788.js","./vec4f64-6d0e93be.js","./nextTick-3ee5a785.js","./byteSizeEstimations-f0cab514.js","./mat3f64-50f3b9f6.js","./mat4f64-abdda1bb.js","./quatf64-f8f1c132.js","./vec2f64-70cfd09e.js"],import.meta.url),WFSSourceWorker:()=>h(()=>import("./WFSSourceWorker-1b556efc.js"),["./WFSSourceWorker-1b556efc.js","./asyncUtils-24bd37b2.js","./jsonMap-ffa742d3.js","./typedArrayUtil-bf9f210a.js","./string-53224faa.js","./Error-5cdd6e0a.js","./ArrayPool-b51874dd.js","./nextTick-3ee5a785.js","./promiseUtils-5940888c.js","./Extent-22afa84a.js","./Ellipsoid-89682c5e.js","./featureConversionUtils-aead6959.js","./aaBoundingBox-fb003858.js","./aaBoundingRect-2fb32e32.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./jsonUtils-36bf3d33.js","./Polyline-82cb63bc.js","./OptimizedFeature-3e582950.js","./OptimizedFeatureSet-1d1ac4b9.js","./FeatureStore-4cc4d41d.js","./Evented-686173eb.js","./BoundsStore-d90f19c6.js","./PooledRBush-2aadabe0.js","./quickselect-56c5966e.js","./optimizedFeatureQueryEngineAdapter-9ce8e144.js","./centroid-0766e68a.js","./QueryEngineResult-0c6179e0.js","./preload-helper-41c905a7.js","./quantizationUtils-16db4e0b.js","./ItemCache-e927309e.js","./MemCache-b4d68123.js","./WhereClause-0699a2ca.js","./executionError-fb3f283a.js","./datetime-eed49b9b.js","./utils-95e81b90.js","./generateRendererUtils-e34cc2cf.js","./enumeration-925aa0f6.js","./projection-4ac247db.js","./SimpleObservable-bd2c3ae8.js","./mat4-f0dc8788.js","./assets-94d592bf.js","./request-09e7d9b2.js","./zscale-baa108ea.js","./json-48e3ea08.js","./SnappingCandidate-970faec6.js","./normalizeUtils-353ec0fc.js","./normalizeUtilsCommon-d8ea404e.js","./geometry-7d866d3f.js","./typeUtils-1714017f.js","./fieldUtils-d430f46c.js","./arcadeOnDemand-dd48afd7.js","./QueryEngine-b5607f4f.js","./QueryEngineCapabilities-42e44ded.js","./FieldsIndex-113320d3.js","./Scheduler-61737382.js","./reactiveUtils-53e5756b.js","./geojson-2fb0c3b0.js","./sourceUtils-b562bcf7.js","./wfsUtils-a9d0db38.js","./xmlUtils-444cb4c0.js","./Field-945b2973.js","./fieldType-24ac97df.js"],import.meta.url),WorkerTileHandler:()=>h(()=>import("./WorkerTileHandler-ecf7be7c.js"),["./WorkerTileHandler-ecf7be7c.js","./promiseUtils-5940888c.js","./string-53224faa.js","./typedArrayUtil-bf9f210a.js","./Error-5cdd6e0a.js","./enums-fb086c25.js","./TileClipper-ae6eca9e.js","./StyleRepository-ba91c1e4.js","./enums-c655c737.js","./enums-fc527c7c.js","./VertexElementDescriptor-2925c6af.js","./Color-7b46c33a.js","./colorUtils-639f4d25.js","./mathUtils-ae09f98b.js","./vec3-8818fe1c.js","./common-d0b63c2d.js","./vec4-c7a19f0d.js","./ArrayPool-b51874dd.js","./colorUtils-c0f43caf.js","./Rect-98da58d6.js","./config-f7904f35.js","./pbf-845dcafd.js","./TurboLine-27a046a4.js","./preload-helper-41c905a7.js","./assets-94d592bf.js","./request-09e7d9b2.js","./earcut-61f7b102.js","./BidiEngine-836b7ef6.js"],import.meta.url)},{CLOSE:y,ABORT:I,INVOKE:S,RESPONSE:d,OPEN_PORT:A,ON:G}=c,q=2;class X{constructor(e){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=e,this._timer=null,this._process=this._process.bind(this)}push(e){e.type===c.ABORT?this._cancelledJobIds.add(e.jobId):(this._invokeMessages.push(e),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const e of this._invokeMessages)this._cancelledJobIds.has(e.jobId)||this._invoke(e);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class u{static connect(e){const t=new MessageChannel;let s;s=typeof e=="function"?new e:"default"in e&&typeof e.default=="function"?new e.default:e;const r=new u(t.port1,{channel:t,client:s},()=>null);return typeof s=="object"&&"remoteClient"in s&&(s.remoteClient=r),u.clients.set(r,s),t.port2}static loadWorker(e){const t=U[e];return t?t():Promise.resolve(null)}constructor(e,t,s){this._port=e,this._getNextJob=s,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new X(r=>this._onInvokeMessage(r)),this._client=t.client,this._onMessage=this._onMessage.bind(this),this._channel=t.channel,this._schedule=t.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:y}),this._close()}isBusy(){return this._outJobs.size>0}invoke(e,t,s){const r=s&&s.signal,n=s&&s.transferList;if(!this._port)return Promise.reject(new v("worker:port-closed",`Cannot call invoke('${e}'), port is closed`,{methodName:e,data:t}));const i=x();return new Promise((l,a)=>{if(J(r))return this._processWork(),void a(f());const p=T(r,()=>{const _=this._outJobs.get(i);_&&(this._outJobs.delete(i),this._processWork(),b(_.abortHandle),this._post({type:I,jobId:i}),a(f()))}),m={resolve:l,reject:a,abortHandle:p,debugInfo:e};this._outJobs.set(i,m),this._post({type:S,jobId:i,methodName:e,abortable:r!=null},t,n)})}on(e,t){const s=new MessageChannel;function r(n){t(n.data)}return this._port.postMessage({type:c.ON,eventType:e,port:s.port2},[s.port2]),s.port1.addEventListener("message",r),s.port1.start(),{remove(){s.port1.postMessage({type:c.CLOSE}),s.port1.close(),s.port1.removeEventListener("message",r)}}}jobAdded(){this._processWork()}openPort(){const e=new MessageChannel;return this._post({type:A,port:e.port2}),e.port1}_processWork(){if(this._outJobs.size>=q)return;const e=this._getNextJob();if(!e)return;const{methodName:t,data:s,invokeOptions:r,deferred:n}=e;this.invoke(t,s,r).then(i=>n.resolve(i)).catch(i=>n.reject(i))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(e=>{b(e.abortHandle),e.reject(f(`Worker closing, aborting job calling '${e.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}_onMessage(e){V(this._schedule)?this._schedule(()=>this._processMessage(e)):this._processMessage(e)}_processMessage(e){const t=O(e);if(t)switch(t.type){case d:this._onResponseMessage(t);break;case S:this._invokeQueue.push(t);break;case I:this._onAbortMessage(t);break;case y:this._onCloseMessage();break;case A:this._onOpenPortMessage(t);break;case G:this._onOnMessage(t)}}_onAbortMessage(e){const t=this._inJobs,s=e.jobId,r=t.get(s);this._invokeQueue.push(e),r&&(r.controller&&r.controller.abort(),t.delete(s))}_onCloseMessage(){const e=this._client;this._close(),e&&"destroy"in e&&u.clients.get(this)===e&&e.destroy(),u.clients.delete(this),e&&e.remoteClient&&(e.remoteClient=null)}_onInvokeMessage(e){const{methodName:t,jobId:s,data:r,abortable:n}=e,i=n?new AbortController:null,l=this._inJobs;let a,p=this._client,m=p[t];try{if(!m&&t&&t.includes(".")){const _=t.split(".");for(let g=0;g<_.length-1;g++)p=p[_[g]],m=p[_[g+1]]}if(typeof m!="function")throw new TypeError(`${t} is not a function`);a=m.call(p,r,{client:this,signal:i?i.signal:null})}catch(_){return void this._post({type:d,jobId:s,error:E(_)})}N(a)?(l.set(s,{controller:i,promise:a}),a.then(_=>{l.has(s)&&(l.delete(s),this._post({type:d,jobId:s},_))},_=>{l.has(s)&&(l.delete(s),j(_)||this._post({type:d,jobId:s,error:E(_||{message:`Error encountered at method ${t}`})}))})):this._post({type:d,jobId:s},a)}_onOpenPortMessage(e){new u(e.port,{client:this._client},()=>null)}_onOnMessage(e){const{port:t}=e,s=this._client.on(e.eventType,n=>{t.postMessage(n)}),r=W(e.port,"message",n=>{var i;((i=O(n))==null?void 0:i.type)===c.CLOSE&&(r.remove(),s.remove(),t.close())})}_onResponseMessage(e){const{jobId:t,error:s,data:r}=e,n=this._outJobs;if(!n.has(t))return;const i=n.get(t);n.delete(t),this._processWork(),b(i.abortHandle),s?i.reject(v.fromJSON(JSON.parse(s))):i.resolve(r)}_post(e,t,s){return L(this._port,e,t,s)}}u.kernelInfo={revision:H,version:$,buildDate:B},u.clients=new Map;class ne{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new Q}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(e,t){return new Promise((s,r)=>{let n=!0;const i=l=>{D(t.signal),n&&(n=!1,l())};this._clients.length=e.length,this._clientPromises.length=e.length,this._inUseClients.length=e.length;for(let l=0;l<e.length;++l){const a=e[l];N(a)?this._clientPromises[l]=a.then(p=>(this._clients[l]=new u(p,t,()=>this._ongoingJobsQueue.pop()??null),i(s),this._clients[l]),()=>(i(r),null)):(this._clients[l]=new u(a,t,()=>this._ongoingJobsQueue.pop()??null),this._clientPromises[l]=Promise.resolve(this._clients[l]),i(s))}})}broadcast(e,t,s){const r=new Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n){const i=this._clientPromises[n];r[n]=i.then(l=>l==null?void 0:l.invoke(e,t,s))}return r}close(){let e;for(;e=this._ongoingJobsQueue.pop();)e.deferred.reject(f(`Worker closing, aborting job calling '${e.methodName}'`));for(const t of this._clientPromises)t.then(s=>s==null?void 0:s.close());this._clients.length=0,this._clientPromises.length=0}invoke(e,t,s){let r;Array.isArray(s)?(R.getLogger("esri.core.workers.Connection").warn("invoke()","The transferList parameter is deprecated, use the options object instead"),r={transferList:s}):r=s;const n=C();this._ongoingJobsQueue.push({methodName:e,data:t,invokeOptions:r,deferred:n});for(let i=0;i<this._clientPromises.length;i++){const l=this._clients[i];l?l.jobAdded():this._clientPromises[i].then(a=>a==null?void 0:a.jobAdded())}return n.promise}on(e,t){return Promise.all(this._clientPromises).then(()=>w(this._clients.map(s=>s.on(e,t))))}openPorts(){return new Promise(e=>{const t=new Array(this._clientPromises.length);let s=t.length;for(let r=0;r<this._clientPromises.length;++r)this._clientPromises[r].then(n=>{n&&(t[r]=n.openPort()),--s==0&&e(t)})})}get test(){return{numClients:this._clients.length}}}export{B as b,H as d,Q as e,O as f,ne as h,L as o,x as r,E as s,c as t,u as w};
