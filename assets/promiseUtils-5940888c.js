import"./string-53224faa.js";import{a as D,s as C}from"./Error-5cdd6e0a.js";import{r as g,t as h,p as S,N as d}from"./typedArrayUtil-bf9f210a.js";function k(e){return{setTimeout:(r,n)=>{const t=e.setTimeout(r,n);return{remove:()=>e.clearTimeout(t)}}}}const x=k(globalThis);function T(e){return e&&(typeof e.on=="function"||typeof e.addEventListener=="function")}function j(e,r,n){if(!T(e))throw new TypeError("target is not a Evented or EventTarget object");if("on"in e)return e.on(r,n);if(Array.isArray(r)){const t=r.slice();for(const o of t)e.addEventListener(o,n);return{remove(){for(const o of t)e.removeEventListener(o,n)}}}return e.addEventListener(r,n),{remove(){e.removeEventListener(r,n)}}}function L(e,r,n){if(!T(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(r,n);const t=j(e,r,o=>{t.remove(),n.call(e,o)});return{remove(){t.remove()}}}function z(e,r,n){let t=!1;const o=j(e,r,i=>{t||n.call(e,i)});return{resume(){t=!1},pause(){t=!0},remove(){o.remove()}}}const M={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function B({key:e}){return M[e]||e}function a(e="Aborted"){return new D("AbortError",e)}function $(e,r="Aborted"){if(N(e))throw a(r)}function f(e){return g(e)?"aborted"in e?e:e.signal:e}function N(e){const r=f(e);return g(r)&&r.aborted}function F(e){if(l(e))throw e}function G(e){if(!l(e))throw e}function w(e,r){const n=f(e);if(!h(n)){if(!n.aborted)return L(n,"abort",()=>r());r()}}function H(e,r){const n=f(e);if(!h(n))return $(n),L(n,"abort",()=>r(a()))}function I(e,r){const n=f(r);return h(n)?e:new Promise((t,o)=>{let i=w(r,()=>o(a()));const c=()=>i=S(i);e.then(c,c),e.then(t,o)})}function l(e){return(e==null?void 0:e.name)==="AbortError"}async function J(e){try{return await e}catch(r){if(!l(r))throw r;return}}async function K(e,r=C.getLogger("esri")){try{return await e}catch(n){l(n)||r.error(n)}}function E(){let e=null;const r=new Promise((n,t)=>{e={promise:void 0,resolve:n,reject:t}});return e.promise=r,e}async function P(e){if(!e)return;if(typeof e.forEach!="function"){const n=Object.keys(e),t=n.map(c=>e[c]),o=await P(t),i={};return n.map((c,s)=>i[c]=o[s]),i}const r=e;return new Promise(n=>{const t=[];let o=r.length;o===0&&n(t),r.forEach(i=>{const c={promise:i||Promise.resolve(i)};t.push(c),c.promise.then(s=>{c.value=s}).catch(s=>{c.error=s}).then(()=>{--o,o===0&&n(t)})})})}async function Q(e){return(await P(e)).filter(r=>!!r.value).map(r=>r.value)}function U(e,r,n){const t=new AbortController;return w(n,()=>t.abort()),new Promise((o,i)=>{let c=setTimeout(()=>{c=0,o(r)},e);w(t,()=>{c&&(clearTimeout(c),i(a()))})})}function O(e){return e&&typeof e.then=="function"}function A(e){return O(e)?e:Promise.resolve(e)}function V(e,r=-1){let n,t,o,i,c=null;const s=(...m)=>{if(n){t=m,i&&i.reject(a()),i=E();const u=d(i.promise);if(c){const v=c;c=null,v.abort()}return u}if(o=i||E(),i=null,r>0){const u=new AbortController;n=A(e(...m,u.signal));const v=n;U(r).then(()=>{n===v&&(i?u.abort():c=u)})}else n=1,n=A(e(...m));const b=()=>{const u=t;t=o=n=c=null,u!=null&&s(...u)},y=n,p=o;return y.then(b,b),y.then(p.resolve,p.reject),d(p.promise)};return s}function X(){let e,r;const n=new Promise((o,i)=>{e=o,r=i}),t=o=>{e(o)};return t.resolve=o=>e(o),t.reject=o=>r(o),t.timeout=(o,i)=>x.setTimeout(()=>t.reject(i),o),t.promise=n,t}function Y(e,r){return e.then(r,r)}async function Z(e){await Promise.resolve(),$(e)}export{A as $,E as A,O as C,X as D,P as E,Q as L,Y as N,Z as O,K as T,U,a,G as b,H as d,T as e,$ as f,J as g,B as i,l as j,z as n,N as p,j as r,x as t,w as v,F as w,V as x,I as y};
